
{% extends 'core/base.html' %}

{% block title %} Новости {% endblock %}
{% block content %}


<div class="container mx-auto">
    <div class="bg-white py-6 sm:py-6">
  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    <div class="mx-auto max-w-2xl lg:mx-0">
      <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">Блог Race-Marketplace</h2>
      <p class="mt-2 text-lg leading-8 text-gray-600">Фотоотчеты, новости и результаты соревнований. Drift, Time-Attack и Drag.</p>


<div class="inline-flex rounded-md shadow-sm mt-2" role="group">
    <a href="/blog/"><button type="button" class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-transparent border border-gray-900 rounded-s-lg hover:bg-gray-900 hover:text-white focus:z-10 focus:ring-2 focus:ring-gray-500 focus:bg-gray-900 focus:text-white dark:border-white dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:bg-gray-700">
<svg class="mr-2" fill="currentColor" width="16px" height="16px" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"> <path d="M494.26,276.22c-3.6-40.41-9.53-48.28-11.77-51.24-5.15-6.84-13.39-11.31-22.11-16l0,0a3.6,3.6,0,0,1-.91-5.68A15.93,15.93,0,0,0,464,190.77,16.27,16.27,0,0,0,447.65,176h-15.6a17,17,0,0,0-2,.13,8.5,8.5,0,0,0-1.41-.47l0,0c-9.24-19.53-21.89-46.27-48.11-59.32C341.64,97,270,96,256,96s-85.64,1-124.48,20.31c-26.22,13.05-38.87,39.79-48.11,59.32l-.08.16a6.52,6.52,0,0,0-1.35.34,17,17,0,0,0-2-.13H64.35A16.27,16.27,0,0,0,48,190.77a15.93,15.93,0,0,0,4.59,12.47,3.6,3.6,0,0,1-.91,5.68l0,0c-8.72,4.72-17,9.19-22.11,16-2.24,3-8.16,10.83-11.77,51.24-2,22.74-2.3,46.28-.73,61.44,3.29,31.5,9.46,50.54,9.72,51.33a16,16,0,0,0,13.2,10.87h0V400a16,16,0,0,0,16,16h56a16,16,0,0,0,16-16h0c8.61,0,14.6-1.54,20.95-3.18a158.83,158.83,0,0,1,28-4.91C207.45,389,237.79,388,256,388c17.84,0,49.52,1,80.08,3.91a159.16,159.16,0,0,1,28.11,4.93c6.08,1.56,11.85,3,19.84,3.15h0a16,16,0,0,0,16,16h56a16,16,0,0,0,16-16v-.12h0A16,16,0,0,0,485.27,389c.26-.79,6.43-19.83,9.72-51.33C496.56,322.5,496.28,299,494.26,276.22ZM112.33,189.31c8-17,17.15-36.24,33.44-44.35,23.54-11.72,72.33-17,110.23-17s86.69,5.24,110.23,17c16.29,8.11,25.4,27.36,33.44,44.35l1,2.17a8,8,0,0,1-7.44,11.42C360,202,290,199.12,256,199.12s-104,2.95-137.28,3.85a8,8,0,0,1-7.44-11.42C111.63,190.81,112,190.06,112.33,189.31Zm11.93,79.63A427.17,427.17,0,0,1,72.42,272c-10.6,0-21.53-3-23.56-12.44-1.39-6.35-1.24-9.92-.49-13.51C49,243,50,240.78,55,240c13-2,20.27.51,41.55,6.78,14.11,4.15,24.29,9.68,30.09,14.06C129.55,263,128,268.64,124.26,268.94Zm221.38,82c-13.16,1.5-39.48.95-89.34.95s-76.17.55-89.33-.95c-13.58-1.51-30.89-14.35-19.07-25.79,7.87-7.54,26.23-13.18,50.68-16.35S233.38,304,256.2,304s32.12,1,57.62,4.81,44.77,9.52,50.68,16.35C375.28,337.4,359.21,349.35,345.64,351Zm117.5-91.39c-2,9.48-13,12.44-23.56,12.44a455.91,455.91,0,0,1-52.84-3.06c-3.06-.29-4.48-5.66-1.38-8.1,5.71-4.49,16-9.91,30.09-14.06,21.28-6.27,33.55-8.78,44.09-6.69,2.57.51,3.93,3.27,4.09,5A40.64,40.64,0,0,1,463.14,259.56Z"/></svg>
    Все категории
  </button></a>

  <a href="/blog/category/drift/"><button type="button" class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-transparent border-t border-b border-gray-900 hover:bg-gray-900 hover:text-white focus:z-10 focus:ring-2 focus:ring-gray-500 focus:bg-gray-900 focus:text-white dark:border-white dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:bg-gray-700">
    <svg class="w-4 h-4 me-2" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 10 70 70" xml:space="preserve">
    <path fill="currentColor" clip-rule="evenodd" d="M65.948,32.912l-2.191,3.074C74.61,45.97,80.901,60.021,80.901,74.882h3.746  C84.647,58.814,77.772,43.621,65.948,32.912z"/>
    <path fill="currentColor" clip-rule="evenodd" d="M52.354,51.517l-2.219,3.021c5.953,4.896,9.5,12.358,9.5,20.344h3.75  C63.386,65.719,59.276,57.131,52.354,51.517z"/>
    <path fill="currentColor" clip-rule="evenodd" d="M59.335,42.006l-2.225,3.032c8.443,7.41,13.385,18.295,13.385,29.844h3.746  C74.241,62.152,68.757,50.142,59.335,42.006z"/>
    <path fill="currentColor" clip-rule="evenodd" d="M40.354,17.423c-0.469-0.318-0.723-0.73-0.703-1.147  c0.047-0.853,1.203-1.489,2.584-1.416c1.375,0.073,2.459,0.817,2.416,1.672c-0.041,0.853-1.197,1.484-2.578,1.416  C41.423,17.912,40.808,17.724,40.354,17.423z M58.538,30.772c-0.443-0.339-0.828-0.887-1.063-1.521  c-0.484-1.297-0.225-2.589,0.578-2.885c0.797-0.298,1.838,0.516,2.316,1.807c0.484,1.297,0.225,2.589-0.578,2.885  c-0.338,0.125-0.744,0.052-1.141-0.203C58.616,30.828,58.573,30.798,58.538,30.772z M48.62,43.517  c-2.145-2.328-4.984-4.88-8.145-7.25c-3.209-2.308-6.49-4.246-9.355-5.594l3.834-7.094c0.063-0.109,0.109-0.511,1.615-0.36  c1.51,0.147,3.691,0.163,9.979,4.776V28l0.006-0.005c6.281,4.614,6.947,6.693,7.541,8.084c0.594,1.396,0.229,1.563,0.141,1.651  L48.62,43.517z M22.813,60.328c-2.781-2.041-7.682-6.342-7.734-10.071l6.078-6.151c1.635,1.859,6.025,5.276,8.438,6.984  c2.354,1.792,6.928,4.958,9.193,5.958l-4.047,7.64C31.167,65.757,25.595,62.371,22.813,60.328z M9.132,63.443  c-1.162-2.333-1.24-4.176-0.418-5.295l1.975-2.688c0.24,0.443,0.443,0.865,0.584,1.251c0.76,2.114,0.254,3.473-0.324,4.26  L9.132,63.443z M23.944,74.314l1.816-2.475c0.578-0.787,1.719-1.678,3.965-1.583c0.41,0.016,0.875,0.083,1.369,0.182l-1.975,2.687  C28.298,74.246,26.517,74.719,23.944,74.314z M13.604,72.876c6.891,5.057,14.74,6.005,17.594,2.119l6.24-8.504l2.256,0.249  c1.932,0.214,3.328-2.692,0.473-3.448l-0.316-0.083l21.801-29.704c1.834-2.5,3.016-8.328-7.416-15.989  C43.804,9.86,38.595,12.74,36.761,15.24L14.96,44.939l-0.178-0.277c-1.572-2.5-3.928-0.295-3.146,1.486l0.918,2.077L6.308,56.73  C3.46,60.615,6.71,67.814,13.604,72.876z"/>
</svg>
    Drift
  </button></a>
      <a href="/blog/category/drag/"><button type="button" class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-transparent border-t border-b border-gray-900 hover:bg-gray-900 hover:text-white focus:z-10 focus:ring-2 focus:ring-gray-500 focus:bg-gray-900 focus:text-white dark:border-white dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:bg-gray-700">
<svg class="mr-2" fill="currentColor" height="16px" width="16px" id="Capa_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 289.939 289.939" xml:space="preserve">
    <g>
	<path id="circle8953" d="M144.969,20.485c-37.119,0-74.239,14.145-102.531,42.438c-56.584,56.584-56.584,148.478,0,205.063
		c1.951,1.955,5.118,1.957,7.072,0.006s1.957-5.118,0.006-7.072c-0.002-0.002-0.004-0.004-0.006-0.006
		c-52.763-52.763-52.763-138.155,0-190.918c52.763-52.763,138.155-52.763,190.918,0c52.763,52.763,52.763,138.155,0,190.918
		c-1.955,1.951-1.959,5.117-0.008,7.072s5.117,1.959,7.072,0.008c0.003-0.003,0.005-0.005,0.008-0.008
		c56.584-56.584,56.584-148.478,0-205.063C219.209,34.63,182.089,20.485,144.969,20.485z M144.969,35.798
		c-32.626,0-65.271,12.458-90.156,37.344c-49.771,49.771-49.771,130.541,0,180.312c0.956,0.996,2.539,1.028,3.535,0.072
		c0.996-0.956,1.028-2.539,0.072-3.535c-0.023-0.024-0.047-0.048-0.072-0.072c-47.86-47.861-47.86-125.38,0-173.24
		c23.93-23.93,55.267-35.881,86.621-35.881c1.381,0.02,2.516-1.084,2.535-2.465s-1.084-2.516-2.465-2.535
		C145.017,35.797,144.993,35.797,144.969,35.798z M224.872,80.405c-1.299,0.039-2.532,0.582-3.438,1.514l-62.701,62.701
		c-3.955-2.627-8.687-4.166-13.764-4.166c-13.748,0-25,11.252-25,25s11.252,25,25,25s25-11.252,25-25
		c0-5.076-1.539-9.809-4.166-13.764l62.701-62.701C231.775,85.81,229.431,80.271,224.872,80.405z M144.969,150.454
		c8.343,0,15,6.657,15,15s-6.657,15-15,15s-15-6.657-15-15S136.626,150.454,144.969,150.454z M144.969,152.954
		c-6.874,0-12.5,5.626-12.5,12.5c-0.02,1.381,1.084,2.516,2.465,2.535c1.381,0.02,2.516-1.084,2.535-2.465c0-0.024,0-0.047,0-0.071
		c0-4.172,3.328-7.5,7.5-7.5c1.381,0.02,2.516-1.084,2.535-2.465c0.02-1.381-1.084-2.516-2.465-2.535
		C145.017,152.953,144.993,152.953,144.969,152.954z"/>
        </g>
        </svg>
        Drag
      </button></a>

    <a href="/blog/category/Time-attack/">
        <button type="button" class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-transparent border border-gray-900 rounded-e-lg hover:bg-gray-900 hover:text-white focus:z-10 focus:ring-2 focus:ring-gray-500 focus:bg-gray-900 focus:text-white dark:border-white dark:text-white dark:hover:text-white dark:hover:bg-gray-700 dark:focus:bg-gray-700">
            <svg class="w-4 h-4 me-2" aria-hidden="true" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path  d="M12 22C16.4183 22 20 18.4183 20 14C20 9.58172 16.4183 6 12 6C7.58172 6 4 9.58172 4 14C4 18.4183 7.58172 22 12 22Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M9 2H15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M15.24 10.76L12 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Time-Attack
        </button></a>
</div>

    </div>
    <div class="mx-auto mt-10 grid max-w-2xl grid-cols-1 gap-x-8 gap-y-16 border-t border-gray-200 pt-10 sm:mt-8 sm:pt-16 lg:mx-0 lg:max-w-none lg:grid-cols-3">
      {% for post in posts %}
        <article class="flex max-w-xl flex-col items-start justify-between">
        <div class="flex items-center gap-x-4">
           <h3 class="mt-3 text-xl font-semibold leading-6 text-gray-900 hover:text-gray-500">
            <a href="{% url 'blog:blogpost_detail' post.slug %}">
                {{ post.title }}
            </a>
          </h3>
        </div>
        <img class="" src="{{ post.image_url|default_if_none:'/media/item_images/default.png' }}" alt="{{ post.title }}">
        <div class="group relative text-xs">
          <a id="{{ post.slug }}" href="" class="btn-post-like">
              <span class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100">
        <button>
            <svg class="w-4 h-4 mr-1" xmlns="http://www.w3.org/2000/svg" {% if logged_user in post.likes.all %} {% else %} fill="none" {% endif %} viewBox="1 -4 25 25" stroke-width="1.5" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"></path></svg>
        </button>{{ post.likes.count }}</span></a>

         <time datetime="2020-03-16" class="text-gray-500">{{ post.created_on.date }}</time>
        {% for category in post.categories.all %}
          <a href="{% url 'blog:blog_category' category.name %}" class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100">{{ category.name }}</a>
            <p class="mt-5 line-clamp-3 text-sm leading-6 text-gray-600">{{ post.body | safe | slice:":200" }}...</p>
        </div>
        <div class="relative mt-6 flex items-center gap-x-4">
          <img src="https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="" class="h-10 w-10 rounded-full bg-gray-50">
          <div class="text-sm leading-6">
            <p class="font-semibold text-gray-900">
              <a href="#">
                <span class="absolute inset-0"></span>
                Michael Foster
              </a>
            </p>
            <p class="text-gray-600">Co-Founder / CTO</p>
          </div>
        </div>
      </article>
                {% endfor %}

        {% endfor %}
    </div>
  </div>
</div>






<script type="text/javascript">
window.CSRF_TOKEN = "{{csrf_token}}"
$(document).on('click', '.btn-post-like', function(){
    var post_id = this.id
    console.log(post_id)
    $.ajax({
        method:"POST",
        url:`/blog/${post_id}/like/`,
        data:{post_id:post_id, csrfmiddlewaretoken:window.CSRF_TOKEN}
    })
    window.location.href="http://127.0.0.1:8000/blog/"
})
</script>

{% endblock %}