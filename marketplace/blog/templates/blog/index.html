
{% extends 'core/base.html' %}

{% block title %} Новости {% endblock %}
{% block content %}


<div class="container mx-auto">
        <h3 class="text-4xl font-bold dark:text-white text-center mb-6">Блог</h3>
<div class="grid grid-cols-3 gap-16">

{% block posts %}
        {% for post in posts %}

            <div class="container mx-auto">
            <h3 class="text-2xl font-bold dark:text-white"><a href="{% url 'blog:blogpost_detail' post.slug %}">{{ post.title }}</a></h3>
                <img class="max-h-60 max-w-lg" src="{{ post.image_url|default_if_none:'/media/item_images/default.png' }}" alt="{{ post.title }}">
            <div><p class="text-left rtl:text-right text-gray-500 dark:text-gray-400">
                {{ post.created_on.date }} | Категория:
                {% for category in post.categories.all %}
                    <a class="font-medium text-blue-600 underline dark:text-blue-500 hover:no-underline" href="{% url 'blog:blog_category' category.name %}">
                        {{ category.name }}
                    </a>
                <a id="{{ post.slug }}" class="btn-post-like"><button class="ml-2 mt-2 text-gray-700 font-medium rounded-full text-sm text-center inline-flex items-center">
<svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"></path></svg>
<span class="sr-only">Like</span><p class="ml-1">{{ post.likes.count }}</p></button></a>
                {% endfor %}
            </p>
            </div>
            <p>{{ post.body | safe | slice:":200" }}...</p>
            </div>
        {% endfor %}
    {% endblock posts %}
    </div>
</div>

<script type="text/javascript">
window.CSRF_TOKEN = "{{csrf_token}}"
$(document).on('click', '.btn-post-like', function(){
    var post_id = this.id
    $.ajax({
        method:"POST",
        url:`/blog/${post_id}/like/`,
        data:{post_id:post_id, csrfmiddlewaretoken:window.CSRF_TOKEN}
    })
})
</script>

{% endblock %}